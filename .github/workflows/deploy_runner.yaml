name: Run Playwright Runner Installation

on:
  workflow_dispatch:
    inputs:
      pipeline_branch:
        description: 'Test pipeline branch name'
        type: string
        required: true
        default: 'main'

jobs:
  Clean_Install_Environments:
    runs-on: ubuntu-latest
    name: Clean Install
    steps:
      - name: Get current workflow branch
        id: get_branch
        run: |
      - name: Checkout pipeline
        uses: actions/checkout@v4
        with:
          ref: 'main'
          repository: 'Netcracker/qubership-test-pipelines'
          path: 'qubership-test-pipelines'
      - name: Create Kubernetes Cluster
        uses: ./qubership-test-pipelines/actions/shared/create_cluster

      - name: Checkout pipeline
        uses: actions/checkout@v4
        with:
          ref: ${{ inputs.pipeline_branch }}
          repository: 'Netcracker/qubership-testing-platform-playwright-runner'
          path: 'qubership-testing-platform-playwright-runner'

      - name: Setup kubectl
        uses: azure/setup-kubectl@v3
        with:
          version: 'v1.32.0'

      - name: Setup Helm
        uses: azure/setup-helm@v3

      - name: Verify tools
        run: |
          kubectl version --client
          helm version
          kubectl get namespaces
